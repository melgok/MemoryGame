@model IEnumerable<MemoryGame.Models.CardModel>

@{
    ViewData["Title"] = "Memory";
}

<h1>Memory yeahh</h1>

<div class="game-board">
    @foreach (var card in Model)
    {
        <div class="card">
            @if (card.IsHidden)
            {
                <form asp-action="PlayTurn" method="post" class="playTurnForm" data-image="@card.Pair.Image">
                    <input type="hidden" name="cardId" value="@card.CardId" />
                    <button type="submit" class="card-back"></button>
                </form>
            }
            else
            {
                <img src="data:image/png;base64,@card.Pair.Image"
                     alt="Card image"
                     class="card-image" />
            }
        </div>
    }
</div>

<script>
    document.querySelectorAll('.playTurnForm').forEach(form => {
        form.addEventListener('submit', function(e) {
            e.preventDefault(); // prevent direct postback
            const image = this.getAttribute('data-image');
            this.outerHTML = `<img src="data:image/png;base64,${image}" class="card-image" />`;

            setTimeout(() => {
                this.submit(); // submit the form to the server after delay
            }, 1000);
        });
    });
</script>

<style>
    .game-board {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 10px;
        justify-items: center;
        margin-top: 20px;
    }

    .card {
        width: 120px;
        height: 120px;
        border: 2px solid black;
        border-radius: 10px;
        overflow: hidden;
        background-color: #f0f0f0;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: transform 0.2s ease;
    }

    .card:hover {
        transform: scale(1.05);
    }

    .card-back {
        width: 100%;
        height: 100%;
        background-color:hotpink;
        border-radius: 8px;
    }

    .card-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 8px;
    }
</style>
